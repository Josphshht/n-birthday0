<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>A Special Day</title>
    <style>
        body, html {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #000; /* This color will show as bars if aspect ratios differ */
        }
        #media-container {
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer; /* Indicates the image is clickable */
        }
        #media-container video,
        #media-container img {
            width: 100%;
            height: 100%;
            /* This ensures the whole media is visible */
            object-fit: contain;
        }
    </style>
</head>
<body>
    <div id="media-container"></div>

    <script>
        // --- Configuration ---
        const friendsBirthday = '06-20'; // IMPORTANT: Set your friend's birthday in MM-DD format.
        const totalDoorImages = 1;      // The total number of door images in your /images folder.
        // NEW: The image to show on the birthday before the video plays.
        const birthdayPresentImage = 'images/present.jpg'; 

        // --- Logic ---
        document.addEventListener('DOMContentLoaded', () => {
            const mediaContainer = document.getElementById('media-container');

            const today = new Date();
            const month = String(today.getMonth() + 1).padStart(2, '0'); // January is 0
            const day = String(today.getDate()).padStart(2, '0');
            const formattedToday = `${month}-${day}`;
            const todayDateString = today.toISOString().split('T')[0]; // YYYY-MM-DD format for caching

            if (formattedToday === friendsBirthday) {
                // --- Birthday Logic: Show a static image first, then play video on click ---
                
                // 1. Create and display the static "present" image
                const presentImg = document.createElement('img');
                presentImg.src = birthdayPresentImage;
                presentImg.alt = 'A Special Surprise!';
                mediaContainer.appendChild(presentImg);

                // 2. Listen for a click on the container
                mediaContainer.addEventListener('click', () => {
                    // 3. Once clicked, remove the image and play the video
                    mediaContainer.innerHTML = ''; // Clear the container
                    mediaContainer.style.cursor = 'default'; // Remove the pointer cursor

                    const video = document.createElement('video');
                    // IMPORTANT: The video is now in the 'videos' folder
                    video.src = 'videos/birthday.mp4'; 
                    video.autoplay = true;
                    video.muted = true;    // Autoplay requires the video to be muted initially.
                    video.controls = true; // Allows the user to unmute and control playback.
                    video.loop = false;
                    video.playsInline = true;
                    
                    mediaContainer.appendChild(video);

                }, { once: true }); // The event listener will only run once.

            } else {
                // --- Regular Day Logic: Display Random Door Image ---
                mediaContainer.style.cursor = 'default'; // No cursor needed for doors
                const cachedImageData = localStorage.getItem('dailyDoorImage');
                let imageUrl;

                if (cachedImageData) {
                    const { date, path } = JSON.parse(cachedImageData);
                    if (date === todayDateString) {
                        imageUrl = path; // Use cached image if the date matches
                    }
                }

                if (!imageUrl) {
                    // No valid cache, so select a new image
                    const randomDoorNumber = Math.floor(Math.random() * totalDoorImages) + 1;
                    imageUrl = `images/door${randomDoorNumber}.jpg`;
                    // Cache the new image path and today's date
                    localStorage.setItem('dailyDoorImage', JSON.stringify({ date: todayDateString, path: imageUrl }));
                }

                const img = document.createElement('img');
                img.src = imageUrl;
                img.alt = 'A mysterious door';
                mediaContainer.appendChild(img);
            }
        });
    </script>
</body>
</html>
